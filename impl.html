import React, { useState, useEffect } from 'react';
import {
Bell, ChevronRight, Home, Bot, Pill, Calendar,
Settings, User, LogOut, Battery, Wifi, AlertCircle,
CheckCircle2, Plus, Edit2, ChevronLeft, Volume2,
Phone, MapPin, Activity, Camera, ArrowRight,
Sofa, Utensils, Bed, Bath, Zap, Mic,
Monitor, RefreshCw, Smartphone, Siren, X,
CloudSun, Lock, List, StopCircle, PlayCircle,
FileText, Search, Mail, Trash2, Video, Sun, Moon,
BatteryCharging, PhoneIncoming, Power
} from 'lucide-react';

/**
* ğŸ¨ Design Tokens & Utilities
*/
const colors = {
primary: { 50: '#EEF4FF', 100: '#D4E4FF', 500: '#3182F6', 600: '#1B64DA' },
safe: { DEFAULT: '#00C471', bg: '#E8F9F0' },
warning: { DEFAULT: '#FF9500', bg: '#FFF4E5' },
danger: { DEFAULT: '#F04452', bg: '#FFEFEF' },
gray: { 50: '#F9FAFB', 100: '#F3F4F6', 200: '#E5E7EB', 300: '#D1D5DB', 400: '#9CA3AF', 500: '#6B7280', 700: '#374151',
900: '#111827' }
};

/**
* ğŸ§± Shared Components
*/
const Button = ({ children, variant = 'primary', size = 'lg', className = '', ...props }) => {
const baseStyle = "w-full font-semibold transition-all active:scale-[0.98] flex items-center justify-center";
const sizes = { sm: "py-2 px-3 text-xs rounded-lg", md: "py-3 px-4 text-sm rounded-xl", lg: "py-4 px-4 text-[15px]
rounded-2xl" };
const getStyle = () => {
if (variant === 'primary') return { backgroundColor: colors.primary[500], color: 'white' };
if (variant === 'secondary') return { backgroundColor: colors.gray[100], color: colors.gray[700] };
if (variant === 'danger') return { backgroundColor: colors.danger.DEFAULT, color: 'white' };
if (variant === 'white') return { backgroundColor: 'white', color: colors.gray[900], border: '1px solid #E5E7EB' };
if (variant === 'dark') return { backgroundColor: '#1F2937', color: 'white' };
return { color: colors.primary[500] };
};
return <button className={`${baseStyle} ${sizes[size]} ${className}`} style={getStyle()} {...props}>{children}</button>;
};

const Card = ({ children, className = '', onClick }) => (
<div onClick={onClick} className={`bg-white rounded-[24px] p-5 shadow-[0_4px_24px_rgba(0,0,0,0.04)] border
    border-gray-100/50 ${onClick ? 'cursor-pointer active:scale-[0.98] transition-transform' : '' } ${className}`}>
    {children}
</div>
);

const Header = ({ title, leftIcon, rightIcon, onLeftClick, onRightClick, transparent = false }) => (
<div className={`sticky top-0 z-50 flex items-center justify-between px-4 min-h-[56px] transition-all ${transparent
    ? 'bg-transparent text-white' : 'bg-white/90 backdrop-blur-md border-b border-gray-100/50 text-gray-900' }`}>
    <div className="w-10">{leftIcon && <button onClick={onLeftClick} className={`p-2 -ml-2 rounded-full
            transition-colors ${transparent ? 'hover:bg-white/10' : 'hover:bg-gray-100' }`}>{leftIcon}</button>}</div>
    <div className="font-bold text-[17px]">{title}</div>
    <div className="w-10 flex justify-end">
        {rightIcon && (
        <button onClick={onRightClick} className={`p-2 -mr-2 relative rounded-full transition-colors ${transparent
            ? 'hover:bg-white/10' : 'hover:bg-gray-100' }`}>
            {rightIcon}
            {rightIcon.type === Bell && <span
                className="absolute top-1.5 right-1.5 w-1.5 h-1.5 bg-red-500 rounded-full border border-white"></span>}
        </button>
        )}
    </div>
</div>
);

const Badge = ({ status, text }) => {
const styles = {
safe: { bg: colors.safe.bg, text: colors.safe.DEFAULT, icon: CheckCircle2 },
warning: { bg: colors.warning.bg, text: colors.warning.DEFAULT, icon: AlertCircle },
danger: { bg: colors.danger.bg, text: colors.danger.DEFAULT, icon: AlertCircle },
neutral: { bg: colors.gray[100], text: colors.gray[600], icon: Activity }
};
const s = styles[status] || styles.neutral;
const Icon = s.icon;
return (
<span className="inline-flex items-center px-2 py-1 rounded-[8px] text-[11px] font-bold" style={{ backgroundColor: s.bg,
    color: s.text }}>
    <Icon size={12} className="mr-1" />{text}
</span>
);
};

const Input = ({ label, type = "text", placeholder, value, icon, className }) => (
<div className={`bg-gray-50 p-4 rounded-2xl border border-gray-100 focus-within:border-blue-500 focus-within:bg-white
    transition-all ${className}`}>
    <label className="block text-xs font-bold text-gray-500 mb-1.5">{label}</label>
    <div className="flex items-center">
        <input type={type} placeholder={placeholder} defaultValue={value}
            className="w-full bg-transparent outline-none text-gray-900 font-semibold placeholder-gray-300 text-[15px]" />
        {icon && <span className="text-gray-400 ml-2">{icon}</span>}
    </div>
</div>
);

const SectionHeader = ({ title, action }) => (
<div className="flex justify-between items-center mb-3 mt-2 px-1">
    <h3 className="font-bold text-lg text-gray-900">{title}</h3>
    {action && action}
</div>
);

// Helper Icon for Settings
const ClockIcon = ({size, className}) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size}
    viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"
    className={className}>
    <circle cx="12" cy="12" r="10"></circle>
    <polyline points="12 6 12 12 16 14"></polyline>
</svg>;

/**
* --------------------------------------------------------------------------
* ğŸ¤– Robot App Components (LCD Screens) - Section 4
* Includes: 4.2 Standby, 4.3 Greeting, 4.4 Medication, 4.5 Emergency, 4.6 Call, 4.7 Charging, 4.8 Sleep
* --------------------------------------------------------------------------
*/
const RobotFaceApp = ({ onLogout, isPreview = false }) => {
const [mode, setMode] = useState('standby');
const [statusMessage, setStatusMessage] = useState("ê¹€ì˜¥ë¶„ë‹˜ì„ ì§€ì¼œë³´ê³  ìˆì–´ìš”");

useEffect(() => {
if (mode !== 'standby') return;
const messages = [
"ê¹€ì˜¥ë¶„ë‹˜ì„ ì§€ì¼œë³´ê³  ìˆì–´ìš”",
"ì‹¤ë‚´ ì˜¨ë„ 24Â°C, ìŠµë„ 45%",
"ë°°í„°ë¦¬ 85% - ì–‘í˜¸í•¨",
"ì˜¤ëŠ˜ ì•½ ë³µìš© ì¼ì •: ì˜¤í›„ 1ì‹œ"
];
let i = 0;
const interval = setInterval(() => {
i = (i + 1) % messages.length;
setStatusMessage(messages[i]);
}, 5000);
return () => clearInterval(interval);
}, [mode]);

const SimControls = () => {
if (isPreview) return null;
return (
<div
    className="fixed bottom-0 left-0 right-0 bg-gray-900/95 backdrop-blur border-t border-gray-700 p-3 z-50 overflow-x-auto">
    <div className="flex space-x-2 min-w-max justify-center px-4">
        <button onClick={()=> setMode('standby')} className={`px-3 py-2 rounded-lg text-xs font-bold ${mode==='standby'
            ? 'bg-blue-600 text-white' : 'bg-gray-700 text-gray-400'}`}>ëŒ€ê¸°</button>
        <button onClick={()=> setMode('greeting')} className={`px-3 py-2 rounded-lg text-xs font-bold
            ${mode==='greeting' ? 'bg-blue-600 text-white' : 'bg-gray-700 text-gray-400'}`}>ì¸ì‚¬</button>
        <button onClick={()=> setMode('medication')} className={`px-3 py-2 rounded-lg text-xs font-bold
            ${mode==='medication' ? 'bg-blue-600 text-white' : 'bg-gray-700 text-gray-400'}`}>ë³µì•½</button>
        <button onClick={()=> setMode('emergency')} className={`px-3 py-2 rounded-lg text-xs font-bold
            ${mode==='emergency' ? 'bg-red-600 text-white' : 'bg-gray-700 text-gray-400'}`}>ê¸´ê¸‰</button>
        <button onClick={()=> setMode('call')} className={`px-3 py-2 rounded-lg text-xs font-bold ${mode==='call' ?
            'bg-green-600 text-white' : 'bg-gray-700 text-gray-400'}`}>í†µí™”</button>
        <button onClick={()=> setMode('charging')} className={`px-3 py-2 rounded-lg text-xs font-bold
            ${mode==='charging' ? 'bg-yellow-600 text-white' : 'bg-gray-700 text-gray-400'}`}>ì¶©ì „</button>
        <button onClick={()=> setMode('sleep')} className={`px-3 py-2 rounded-lg text-xs font-bold ${mode==='sleep' ?
            'bg-purple-600 text-white' : 'bg-gray-700 text-gray-400'}`}>ìˆ˜ë©´</button>
        <div className="w-px h-8 bg-gray-700 mx-2"></div>
        <button onClick={onLogout}
            className="px-3 py-2 rounded-lg text-xs font-bold bg-gray-800 text-red-400 border border-red-900/50">ì¢…ë£Œ</button>
    </div>
</div>
);
};

const containerClass = isPreview
? "h-full w-full bg-black text-white flex flex-col items-center justify-center relative overflow-hidden font-sans
scale-[0.8] origin-center"
: "min-h-screen bg-black text-white flex flex-col items-center justify-center relative overflow-hidden font-sans";

// 4.2 ëŒ€ê¸° í™”ë©´
if (mode === 'standby') {
return (
<div className={containerClass}>
    <div className="absolute top-6 right-6 flex space-x-3 text-gray-500">
        <Wifi size={20} />
        <Battery size={20} />
    </div>
    <div className="absolute top-6 left-6 flex space-x-2 text-gray-500 text-sm font-medium">
        <CloudSun size={20} /> <span>24Â°C</span>
    </div>
    <div className="text-[120px] animate-pulse-slow transform hover:scale-110 transition-transform cursor-pointer select-none"
        onClick={()=> setMode('greeting')}>ğŸ˜Š</div>
    <div className="mt-8 text-center space-y-1">
        <h1 className="text-6xl font-bold tracking-tight">14:30</h1>
        <p className="text-xl text-gray-400 font-medium">1ì›” 20ì¼ (í™”)</p>
    </div>
    {!isPreview && (
    <div
        className="absolute bottom-24 bg-gray-800/50 backdrop-blur-md px-6 py-3 rounded-full flex items-center space-x-3 border border-gray-700 transition-all duration-500">
        <span className="w-2 h-2 bg-green-500 rounded-full animate-pulse"></span>
        <span className="text-sm font-medium text-gray-300">{statusMessage}</span>
    </div>
    )}
    <SimControls />
</div>
);
}

// 4.3 ì¸ì‚¬ í™”ë©´
if (mode === 'greeting') {
return (
<div className={`${containerClass} bg-gradient-to-b from-blue-900 to-black`}>
    <div className="text-[140px] mb-6 animate-wobble select-none">ğŸ¥°</div>
    <h2 className="text-4xl font-bold mb-4 leading-tight text-center">"ë‹¤ë…€ì˜¤ì…¨ì–´ìš”,<br />ê¹€ì˜¥ë¶„ë‹˜!"</h2>
    <p className="text-xl text-blue-200 text-center mb-8">ì˜¤ëŠ˜ ê¸°ë¶„ì€ ì–´ë– ì„¸ìš”?<br />ë”°ëœ»í•œ ì°¨ í•œ ì” ì–´ë•Œìš”? ğŸµ</p>
    <div className="flex items-center space-x-2 bg-white/10 px-4 py-2 rounded-full backdrop-blur-sm animate-pulse">
        <Mic size={16} className="text-white" /><span className="text-sm text-white/80">ë§ì”€ì„ ë“£ê³  ìˆì–´ìš”...</span>
    </div>
    <SimControls />
</div>
);
}

// 4.4 ë³µì•½ ì•Œë¦¼ í™”ë©´
if (mode === 'medication') {
return (
<div className={`${containerClass} bg-orange-600`}>
    <div className="absolute inset-0 opacity-10 pattern-dots"></div>
    <div className="absolute inset-0 border-[10px] border-orange-400/30 animate-pulse"></div>
    <div className="relative z-10 text-center flex flex-col items-center">
        <div
            className="bg-white text-orange-600 w-40 h-40 rounded-full flex items-center justify-center mb-6 shadow-2xl animate-bounce">
            <Pill size={80} />
        </div>
        <h2 className="text-4xl font-bold mb-2">ì•½ ë“œì‹¤ ì‹œê°„ì´ì—ìš”!</h2>
        <p className="text-2xl text-orange-100 font-medium mb-10">ì ì‹¬ ì‹í›„ 30ë¶„ ì•½</p>
        <div
            className="bg-black/20 backdrop-blur-sm rounded-[24px] p-6 text-left w-full max-w-xs mx-auto border border-white/20 shadow-lg">
            <div className="flex items-center space-x-4">
                <div className="w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center text-3xl">ğŸ’Š</div>
                <div>
                    <div className="font-bold text-xl">í˜ˆì••ì•½, ë¹„íƒ€ë¯¼</div>
                    <div className="text-orange-100">ì´ 2ì •</div>
                </div>
            </div>
            <div className="mt-4 pt-4 border-t border-white/10">
                <div
                    className="flex items-center justify-center space-x-2 text-white/90 text-sm font-bold animate-pulse">
                    <ArrowRight size={16} /> <span>ì•½ì´ ë‚˜ì˜¤ê³  ìˆìŠµë‹ˆë‹¤...</span>
                </div>
            </div>
        </div>
    </div>
    <SimControls />
</div>
);
}

// 4.5 ê¸´ê¸‰ í™”ë©´
if (mode === 'emergency') {
return (
<div className={`${containerClass} bg-red-700`}>
    <div className="absolute inset-0 bg-red-900/50 animate-ping opacity-20"></div>
    <div className="relative z-10 flex flex-col items-center text-center p-6">
        <Siren size={120} className="text-white mb-6 animate-pulse" />
        <h1 className="text-5xl font-extrabold mb-4 drop-shadow-md">ê¸´ê¸‰ ìƒí™©!</h1>
        <p className="text-2xl text-red-100 mb-8 font-bold">ë³´í˜¸ìì—ê²Œ ì—°ë½ ì¤‘ì…ë‹ˆë‹¤</p>
        <div className="w-full max-w-xs bg-black/30 backdrop-blur rounded-2xl p-4 border border-white/20">
            <div className="flex items-center space-x-3 text-left">
                <div className="bg-white p-2 rounded-full">
                    <PhoneIncoming className="text-red-600" size={24} />
                </div>
                <div>
                    <div className="text-xs text-red-200">Calling...</div>
                    <div className="font-bold text-lg">ì•„ë“¤ (010-1234-5678)</div>
                </div>
            </div>
        </div>
    </div>
    <SimControls />
</div>
);
}

// 4.6 ì˜ìƒ í†µí™” í™”ë©´
if (mode === 'call') {
return (
<div className={`${containerClass} bg-gray-900`}>
    <div className="absolute inset-0 flex items-center justify-center opacity-30">
        <User size={300} className="text-gray-700" />
    </div>
    <div className="relative z-10 flex flex-col items-center justify-between h-full py-16">
        <div className="text-center">
            <div
                className="w-24 h-24 bg-gray-200 rounded-full mx-auto mb-4 flex items-center justify-center text-4xl border-4 border-gray-700">
                ğŸ‘¨â€ğŸ’¼</div>
            <h2 className="text-3xl font-bold">ê¹€ë³µì§€ ë³µì§€ì‚¬</h2>
            <p className="text-green-400 mt-2 flex items-center justify-center">
                <Wifi size={16} className="mr-1" /> ì—°ê²° ìƒíƒœ ì¢‹ìŒ
            </p>
        </div>

        <div className="flex space-x-8 mt-auto">
            <button
                className="w-16 h-16 bg-red-500 rounded-full flex items-center justify-center shadow-lg hover:scale-110 transition-transform">
                <Phone size={32} className="text-white rotate-[135deg]" />
            </button>
            <button
                className="w-16 h-16 bg-green-500 rounded-full flex items-center justify-center shadow-lg hover:scale-110 transition-transform animate-pulse"><Video
                    size={32} className="text-white" /></button>
        </div>
    </div>
    <SimControls />
</div>
);
}

// 4.7 ì¶©ì „ í™”ë©´
if (mode === 'charging') {
return (
<div className={`${containerClass} bg-black`}>
    <div className="flex flex-col items-center justify-center h-full">
        <div className="relative mb-8">
            <div className="text-[120px] text-green-400 opacity-80">ğŸ˜Œ</div>
            <div className="absolute -top-4 -right-4 text-yellow-400 animate-bounce">
                <BatteryCharging size={48} />
            </div>
        </div>
        <div className="w-64 h-4 bg-gray-800 rounded-full overflow-hidden mb-4 border border-gray-700">
            <div className="h-full bg-gradient-to-r from-green-600 to-green-400 w-[85%] relative overflow-hidden">
                <div className="absolute inset-0 bg-white/20 animate-pulse"></div>
            </div>
        </div>
        <h2 className="text-3xl font-bold text-green-400">ì¶©ì „ ì¤‘ 85%</h2>
        <p className="text-gray-500 mt-2">ì™„ì¶©ê¹Œì§€ ì•½ 25ë¶„ ë‚¨ìŒ</p>
    </div>
    <SimControls />
</div>
);
}

// 4.8 ìˆ˜ë©´ í™”ë©´
if (mode === 'sleep') {
return (
<div className={`${containerClass} bg-black`}>
    <div className="flex flex-col items-center justify-center h-full opacity-60">
        <div className="text-[100px] mb-4">ğŸ˜´</div>
        <div className="flex items-center space-x-2 text-purple-300">
            <Moon size={20} />
            <span className="text-lg font-medium">ìˆ˜ë©´ ëª¨ë“œ</span>
        </div>
        <div className="absolute top-1/3 right-1/3 text-4xl text-purple-400 font-bold animate-bounce opacity-50"
            style={{animationDuration: '2s' }}>Z</div>
        <div className="absolute top-1/4 right-1/4 text-2xl text-purple-400 font-bold animate-bounce opacity-40"
            style={{animationDuration: '2.5s' , animationDelay: '0.5s' }}>z</div>
    </div>
    <SimControls />
</div>
);
}

return null;
};

/**
* --------------------------------------------------------------------------
* ğŸ“± Guardian App Screens - Section 3 (Restored Fully)
* --------------------------------------------------------------------------
*/

// 3.1 Login Screen
const LoginScreen = ({ onLogin, onSignup }) => {
const [role, setRole] = useState('guardian');

return (
<div className="min-h-screen bg-white flex flex-col justify-center p-6">
    <div className="mb-8 text-center">
        <div
            className="w-20 h-20 bg-blue-500 rounded-[28px] mx-auto mb-6 flex items-center justify-center text-4xl shadow-xl shadow-blue-200">
            ğŸ¤–</div>
        <h1 className="text-2xl font-bold text-gray-900 mb-2">AI ë°˜ë ¤ë¡œë´‡</h1>
        <p className="text-gray-500">ì–´ë¥´ì‹ ì˜ ì•ˆì „í•œ í•˜ë£¨ë¥¼ ì§€ì¼œë“œë ¤ìš”</p>
    </div>

    <div className="bg-gray-100 p-1.5 rounded-2xl flex mb-8">
        <button onClick={()=> setRole('guardian')} className={`flex-1 py-3 rounded-xl text-sm font-bold transition-all
            duration-200 ${role === 'guardian' ? 'bg-white shadow-sm text-gray-900' : 'text-gray-400
            hover:text-gray-600'}`}>ë³´í˜¸ì/ê°€ì¡±</button>
        <button onClick={()=> setRole('robot')} className={`flex-1 py-3 rounded-xl text-sm font-bold transition-all
            duration-200 ${role === 'robot' ? 'bg-white shadow-sm text-gray-900' : 'text-gray-400
            hover:text-gray-600'}`}>ë¡œë´‡ ë³¸ì²´</button>
    </div>

    <div className="space-y-4 animate-fade-in-up">
        {role === 'guardian' ? (
        <>
            <Input label="ì´ë©”ì¼" type="email" value="worker@toss.im" icon="ğŸ“§" />
            <Input label="ë¹„ë°€ë²ˆí˜¸" type="password" value="12341234" icon="ğŸ”’" />
            <div className="pt-2"><Button onClick={()=> onLogin('guardian')}>ë¡œê·¸ì¸</Button></div>
            <div className="flex justify-center items-center space-x-2 mt-4"><span className="text-xs text-gray-400">ê³„ì •ì´
                    ì—†ìœ¼ì‹ ê°€ìš”?</span><button onClick={onSignup} className="text-xs font-bold text-blue-500">íšŒì›ê°€ì…</button>
            </div>
        </>
        ) : (
        <>
            <Input label="ê¸°ê¸° ì‹œë¦¬ì–¼ ë„˜ë²„" type="text" value="ROBOT-2026-X82" icon="#" />
            <Input label="ì¸ì¦ ì½”ë“œ" type="password" value="9999" icon="ğŸ”‘" />
            <div className="pt-2"><Button onClick={()=> onLogin('robot')} variant="dark">ë¡œë´‡ ì‹œì‘í•˜ê¸°</Button></div>
            <p className="text-center text-xs text-gray-400 mt-4">ë¡œë´‡ì˜ LCD í™”ë©´ì—ì„œ ì‹¤í–‰ë˜ëŠ” ëª¨ë“œì…ë‹ˆë‹¤.</p>
        </>
        )}
    </div>
</div>
);
};

// 3.2 Signup Screen
const SignupScreen = ({ onBack, onComplete }) => (
<div className="min-h-screen bg-white p-6 pb-safe">
    <div className="flex items-center mb-8"><button onClick={onBack} className="p-2 -ml-2 text-gray-800">
            <ChevronLeft size={24} />
        </button><span className="font-bold text-lg ml-2">íšŒì›ê°€ì…</span></div>
    <div className="space-y-6 animate-fade-in-up">
        <div>
            <h2 className="text-xl font-bold text-gray-900 mb-1">í™˜ì˜í•©ë‹ˆë‹¤! ğŸ‘‹</h2>
            <p className="text-gray-500 text-sm">ë³´í˜¸ì(ë³µì§€ì‚¬) ê³„ì •ì„ ìƒì„±í•©ë‹ˆë‹¤.</p>
        </div>
        <div className="space-y-3">
            <Input label="ì´ë¦„ *" placeholder="ì‹¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš”" />
            <Input label="ì´ë©”ì¼ *" placeholder="example@email.com" />
            <div><Input label="ë¹„ë°€ë²ˆí˜¸ *" type="password" placeholder="8ì ì´ìƒ ì…ë ¥" />
                <p className="text-[11px] text-gray-400 flex items-center ml-1 mt-1">
                    <AlertCircle size={10} className="mr-1" /> 8ì ì´ìƒ, ì˜ë¬¸/ìˆ«ì ì¡°í•©
                </p>
            </div>
            <Input label="ì—°ë½ì²˜" placeholder="010-0000-0000" />
        </div>
        <div className="pt-4"><Button onClick={onComplete}>ê°€ì…í•˜ê¸°</Button></div>
    </div>
</div>
);

// 3.3 Elder Select Screen
const ElderSelectScreen = ({ onSelect, onSettings, onEmergency }) => {
const elders = [
{ id: 1, name: 'ë°•ì˜ì', age: 82, status: 'danger', lastCheck: '5ë¶„ ì „', location: 'ë‚™ìƒ ê°ì§€ë¨' },
{ id: 2, name: 'ê¹€ì˜¥ë¶„', age: 80, status: 'safe', lastCheck: '10ë¶„ ì „', location: 'ì•ˆì „' },
{ id: 3, name: 'ì´ìˆœí¬', age: 78, status: 'safe', lastCheck: '25ë¶„ ì „', location: 'ì•ˆì „' },
{ id: 4, name: 'ìµœì˜ìˆ˜', age: 85, status: 'warning', lastCheck: '2ì‹œê°„ ì „', location: 'ì™¸ì¶œ ì¤‘' },
];
return (
<div className="min-h-screen bg-gray-50 pb-safe">
    <Header title="ê´€ë¦¬ ëŒ€ìƒ ì„ íƒ" rightIcon={<Settings size={20} />} onRightClick={onSettings} />
    <div className="p-5 space-y-6 animate-fade-in">
        <div className="bg-white p-5 rounded-[20px] shadow-sm border border-gray-100">
            <h2 className="text-[20px] font-bold text-gray-900 mb-1">ì•ˆë…•í•˜ì„¸ìš”, ê¹€ë³µì§€ì‚¬ë‹˜ ğŸ‘‹</h2>
            <p className="text-gray-500 text-[14px]">ì˜¤ëŠ˜ ê´€ë¦¬ ëŒ€ìƒ: <span className="font-bold text-blue-500">4ëª…</span></p>
        </div>
        {elders.some(e => e.status === 'danger') && (
        <div className="animate-pulse">
            <div className="mb-2 text-red-500 font-bold text-sm flex items-center ml-1">
                <div className="w-2 h-2 bg-red-500 rounded-full mr-2 animate-ping"></div>ê¸´ê¸‰ ìƒí™© (1ëª…)
            </div>
            {elders.filter(e => e.status === 'danger').map(elder => (
            <Card key={elder.id} onClick={()=> onEmergency(elder)} className="border-2 border-red-100 !bg-red-50
                relative overflow-hidden cursor-pointer shadow-md shadow-red-100">
                <div className="absolute top-0 left-0 w-1.5 h-full bg-red-500"></div>
                <div className="flex justify-between items-start">
                    <div>
                        <div className="flex items-center space-x-2">
                            <h3 className="text-lg font-bold text-gray-900">{elder.name} ë‹˜</h3><span
                                className="text-sm text-gray-500">Â· {elder.age}ì„¸</span>
                        </div>
                        <p className="text-red-500 font-bold mt-1 text-[15px]">ğŸš¨ {elder.location}</p>
                    </div>
                    <Badge status="danger" text="ê¸´ê¸‰" />
                </div>
                <div className="mt-4 pt-4 border-t border-red-200/50 flex justify-between items-center"><span
                        className="text-xs text-red-400 font-medium">{elder.lastCheck}</span><span
                        className="text-sm font-bold text-red-600 flex items-center bg-white/50 px-3 py-1.5 rounded-lg shadow-sm">ì¦‰ì‹œ
                        í™•ì¸
                        <ChevronRight size={16} />
                    </span></div>
            </Card>
            ))}
        </div>
        )}
        <div className="space-y-3">
            <div className="flex justify-between items-center px-1">
                <p className="text-sm font-bold text-gray-500">ì •ìƒ ëª©ë¡ ({elders.filter(e => e.status !==
                    'danger').length}ëª…)</p>
            </div>
            {elders.filter(e => e.status !== 'danger').map(elder => (
            <Card key={elder.id} onClick={()=> onSelect(elder)} className="active:scale-[0.98] transition-transform
                hover:shadow-md">
                <div className="flex justify-between items-center">
                    <div className="flex items-center space-x-4">
                        <div className={`w-12 h-12 rounded-2xl flex items-center justify-center text-lg font-bold
                            shadow-sm ${elder.status==='safe' ? 'bg-green-50 text-green-600'
                            : 'bg-orange-50 text-orange-600' }`}>{elder.name[0]}</div>
                        <div>
                            <div className="flex items-center space-x-2">
                                <h3 className="text-[16px] font-bold text-gray-900">{elder.name} ë‹˜</h3>
                                <Badge status={elder.status} text={elder.status==='safe' ? 'ì•ˆì „' : 'ì™¸ì¶œ' } />
                            </div>
                            <p className="text-sm text-gray-500 mt-0.5">{elder.lastCheck} Â· {elder.status === 'safe' ?
                                'ğŸŸ¢ ì •ìƒ í™œë™ ì¤‘' : 'ğŸŸ¡ ë³‘ì› ì˜ˆì•½'}</p>
                        </div>
                    </div>
                    <ChevronRight size={20} className="text-gray-300" />
                </div>
            </Card>
            ))}
        </div>
    </div>
</div>
);
};

// 3.4 Dashboard Screen
const DashboardScreen = ({ elder, onBack, onNoti, onHistory }) => {
if (!elder) return <div className="min-h-screen bg-gray-50 flex items-center justify-center text-gray-500">Loading...
</div>;

return (
<div className="min-h-screen bg-gray-50 pb-24 animate-fade-in">
    <Header leftIcon={<ChevronLeft size={24} />} onLeftClick={onBack} title={<div
        className="flex items-center space-x-1"><span>{elder.name} ë‹˜</span><span
            className="text-xs bg-gray-100 px-1.5 py-0.5 rounded text-gray-500">â–¼</span></div>} rightIcon={
    <Bell size={24} />} onRightClick={onNoti} />
    <div className="p-5 space-y-6">
        <Card className="text-center py-8">
            <div
                className="mb-4 inline-flex items-center justify-center w-20 h-20 bg-blue-50 rounded-full text-4xl shadow-md shadow-blue-100">
                ğŸ˜Š</div>
            <h2 className="text-xl font-bold text-gray-900 mb-1">"{elder.name} ë‹˜ì€ ì•ˆì „í•©ë‹ˆë‹¤"</h2>
            <p className="text-sm text-gray-500 mb-6">ë§ˆì§€ë§‰ í™•ì¸: ì˜¤ì „ 10:23 <span
                    className="text-green-500 font-bold ml-1">ğŸŸ¢ ì •ìƒ</span></p>
            <div className="grid grid-cols-3 gap-2 border-t border-gray-100 pt-6">
                <div onClick={onHistory} className="cursor-pointer active:opacity-70">
                    <div className="text-sm text-gray-400 mb-1">ğŸŒ… ê¸°ìƒ</div>
                    <div className="text-lg font-bold text-gray-900">07:30</div>
                </div>
                <div className="border-l border-gray-100">
                    <div className="text-sm text-gray-400 mb-1">ğŸ’Š ë³µì•½</div>
                    <div className="text-lg font-bold text-blue-500">1/2</div>
                </div>
                <div className="border-l border-gray-100">
                    <div className="text-sm text-gray-400 mb-1">ğŸƒ í™œë™</div>
                    <div className="text-lg font-bold text-gray-900">ë³´í†µ</div>
                </div>
            </div>
        </Card>
        <section>
            <SectionHeader title="ì•ˆì‹¬ ì§€ë„" action={<button className="text-sm text-blue-500 font-medium">ì „ì²´ë³´ê¸° â†’</button>}
                />
                <Card className="h-56 relative bg-gray-100 overflow-hidden border border-gray-200 !p-0">
                    <div className="absolute inset-0 bg-[#f8f9fa] flex items-center justify-center">
                        <div className="grid grid-cols-2 gap-2 w-3/4 h-3/4 opacity-50">
                            {['ì¹¨ì‹¤','ê±°ì‹¤','í™”ì¥ì‹¤','ì£¼ë°©'].map(r=><div key={r}
                                className="border-2 border-gray-300 rounded-lg flex items-center justify-center text-xs text-gray-400 bg-white">
                                {r}</div>)}
                        </div>
                        <div className="absolute top-1/3 left-2/3 transform -translate-x-1/2 -translate-y-1/2">
                            <div
                                className="w-4 h-4 bg-blue-500 rounded-full border-2 border-white shadow-lg animate-ping absolute opacity-75">
                            </div>
                            <div
                                className="w-4 h-4 bg-blue-500 rounded-full border-2 border-white shadow-lg relative z-10">
                            </div>
                            <div
                                className="bg-white/90 backdrop-blur px-2 py-1 rounded text-[10px] font-bold shadow-sm absolute -top-8 -left-4 whitespace-nowrap">
                                ğŸ¤– ë¡œë´‡ (ê±°ì‹¤)</div>
                        </div>
                    </div>
                </Card>
        </section>
        <section>
            <SectionHeader title="ìˆœì°° í”¼ë“œ" />
            <div className="flex space-x-3 overflow-x-auto pb-4 -mx-5 px-5 scrollbar-hide">
                {[{ label: 'ê°€ìŠ¤ë°¸ë¸Œ', status: 'ì •ìƒ', time: '09:30', icon: 'ğŸ”¥' }, { label: 'í˜„ê´€ë¬¸', status: 'ì ê¹€', time:
                '09:32', icon: 'ğŸšª' }, { label: 'ì½˜ì„¼íŠ¸', status: 'ì •ìƒ', time: '09:35', icon: 'zap' }].map((item, idx) => (
                <div key={idx} className="flex-shrink-0 w-32 bg-white p-4 rounded-2xl shadow-sm border border-gray-100">
                    <div className="text-2xl mb-2">{item.icon === 'zap' ?
                        <Zap size={24} className="text-yellow-500" /> : item.icon}
                    </div>
                    <div className="font-bold text-gray-900 text-sm mb-0.5">{item.label}</div>
                    <div className="text-xs text-green-600 font-medium mb-2 flex items-center">
                        <div className="w-1.5 h-1.5 bg-green-500 rounded-full mr-1"></div>
                        {item.status}
                    </div>
                    <div className="text-xs text-gray-400">{item.time}</div>
                </div>
                ))}
            </div>
        </section>
        <section>
            <SectionHeader title="ë¡œë´‡ ìƒíƒœ" />
            <Card className="flex justify-between items-center py-4">
                <div className="flex items-center space-x-2">
                    <Battery className="text-green-500" size={20} /><span className="font-bold text-gray-900">85%</span>
                </div>
                <div className="w-px h-4 bg-gray-200"></div>
                <div className="flex items-center space-x-2">
                    <Wifi className="text-blue-500" size={20} /><span className="font-bold text-gray-900">ì—°ê²°ë¨</span>
                </div>
                <div className="w-px h-4 bg-gray-200"></div>
                <div className="flex items-center space-x-2">
                    <Pill className="text-orange-500" size={20} /><span className="font-bold text-gray-900">3ê°œ ë‚¨ìŒ</span>
                </div>
            </Card>
        </section>
    </div>
</div>
);
};

// 3.5 Schedule Screen
const ScheduleScreen = ({ onBack, onNoti }) => {
const dates = [{ d: 'ì¼', v: 19 }, { d: 'ì›”', v: 20, today: true }, { d: 'í™”', v: 21 }, { d: 'ìˆ˜', v: 22 }, { d: 'ëª©', v: 23
}, { d: 'ê¸ˆ', v: 24 }, { d: 'í† ', v: 25 }];
return (
<div className="min-h-screen bg-gray-50 pb-24">
    <Header leftIcon={<ChevronLeft size={24} />} onLeftClick={onBack} title="ì¼ì • ê´€ë¦¬" rightIcon={
    <Bell size={24} />} onRightClick={onNoti} />
    <div className="bg-white pb-4 border-b border-gray-100">
        <div className="flex justify-between items-center px-6 py-3">
            <span className="text-lg font-bold text-gray-900">2026ë…„ 1ì›”</span>
            <div className="flex space-x-4 text-gray-400"><button className="p-1 hover:bg-gray-100 rounded-full">
                    <ChevronLeft size={20} />
                </button><button className="p-1 hover:bg-gray-100 rounded-full">
                    <ChevronRight size={20} />
                </button></div>
        </div>
        <div className="flex justify-between px-4 mt-1 text-center">
            {dates.map((item, i) => (
            <div key={i} className={`flex flex-col items-center w-10 py-2 rounded-xl transition-colors cursor-pointer
                ${item.today ? 'bg-blue-50' : 'hover:bg-gray-50' }`}>
                <span className={`text-xs mb-1 ${item.today ? 'text-blue-500 font-bold' : 'text-gray-400'
                    }`}>{item.d}</span>
                <span className={`text-[15px] ${item.today ? 'font-bold text-blue-600' : 'text-gray-700 font-medium'
                    }`}>{item.v}</span>
                {item.today && <div className="w-1 h-1 bg-blue-500 rounded-full mt-1.5"></div>}
            </div>
            ))}
        </div>
    </div>
    <div className="p-5 space-y-4">
        <div className="bg-white p-5 rounded-[20px] shadow-sm border border-blue-100 relative overflow-hidden">
            <div className="absolute top-0 left-0 w-1 h-full bg-blue-500"></div>
            <div className="flex justify-between items-start mb-3">
                <div className="flex items-center space-x-2 text-blue-600 font-bold text-sm">
                    <div className="p-1 bg-blue-100 rounded-full">
                        <Mic size={12} />
                    </div><span>ìŒì„±ìœ¼ë¡œ ë“±ë¡ëœ ì¼ì • (1ê±´)</span>
                </div>
                <button className="text-xs text-gray-400 font-medium">í¼ì¹˜ê¸°</button>
            </div>
            <div className="pl-1">
                <div className="flex items-center mb-1"><span className="text-xl mr-2">ğŸ™ï¸</span>
                    <p className="text-[15px] font-bold text-gray-900">"ì†ì ìƒì¼ ì¼€ì´í¬ ì‚¬ê¸°"</p>
                </div>
                <p className="text-xs text-gray-500 pl-7">01/22 (ìˆ˜) Â· ì–´ë¥´ì‹ ì´ ì§ì ‘ ë“±ë¡</p>
            </div>
        </div>
        <div className="pt-2">
            <h3 className="text-lg font-bold text-gray-900 mb-3">1ì›” 20ì¼ (ì›”) - ì˜¤ëŠ˜</h3>
            <Card className="mb-3 flex items-start space-x-4 border-l-0">
                <div className="flex flex-col items-center space-y-1 pt-1">
                    <div className="text-2xl bg-gray-50 p-2 rounded-xl">ğŸ¥</div>
                    <div className="w-0.5 h-full bg-gray-100 min-h-[20px]"></div>
                </div>
                <div className="flex-1 pt-1">
                    <div className="flex justify-between items-start">
                        <h4 className="font-bold text-gray-900 text-[16px]">ë³‘ì› ì˜ˆì•½</h4><span
                            className="text-xs font-bold text-orange-500 bg-orange-50 px-2 py-1 rounded">2ì‹œê°„ ì „</span>
                    </div>
                    <p className="text-sm text-gray-600 mt-1">ì˜¤í›„ 2:00 Â· ë‚´ê³¼ ì •ê¸°ê²€ì§„</p>
                    <p className="text-xs text-gray-400 mt-0.5 flex items-center">
                        <MapPin size={10} className="mr-1" /> ì„œìš¸ëŒ€ë³‘ì›
                    </p>
                </div>
            </Card>
            <Card className="flex items-start space-x-4 opacity-50">
                <div className="flex flex-col items-center space-y-1 pt-1">
                    <div className="text-2xl bg-gray-50 p-2 rounded-xl">ğŸ’Š</div>
                </div>
                <div className="flex-1 pt-1">
                    <div className="flex justify-between items-center">
                        <h4 className="font-bold text-gray-900 text-[16px] line-through">ì•„ì¹¨ ì•½ ë³µìš©</h4>
                        <CheckCircle2 size={16} className="text-green-500" />
                    </div>
                    <p className="text-sm text-gray-600 mt-1">ì˜¤ì „ 8:00 Â· ì™„ë£Œ</p>
                </div>
            </Card>
            <Card className="flex items-start space-x-4 mt-3">
                <div className="flex flex-col items-center space-y-1 pt-1">
                    <div className="text-2xl bg-gray-50 p-2 rounded-xl">ğŸ’Š</div>
                </div>
                <div className="flex-1 pt-1">
                    <div className="flex justify-between items-start">
                        <h4 className="font-bold text-gray-900 text-[16px]">ì €ë… ì•½ ë³µìš©</h4>
                    </div>
                    <p className="text-sm text-gray-600 mt-1">ì˜¤í›„ 7:00 Â· ê³ í˜ˆì••ì•½, ë‹¹ë‡¨ì•½</p>
                </div>
            </Card>
        </div>
        <Button variant="secondary" className="mt-4 text-blue-500 bg-blue-50">
            <Plus size={18} className="mr-2" /> ì¼ì • ì¶”ê°€
        </Button>
    </div>
</div>
);
};

// 3.6 RobotControl Screen
const RobotControlScreen = ({ onBack, onLcd }) => (
<div className="min-h-screen bg-gray-50 pb-24">
    <Header leftIcon={<ChevronLeft size={24} />} onLeftClick={onBack} title="ë¡œë´‡ ì œì–´" />
    <div className="p-5 space-y-6">
        <section>
            <h3 className="font-bold text-lg text-gray-900 mb-3">ë¡œë´‡ ìƒíƒœ</h3>
            <Card className="relative pt-8">
                <div
                    className="absolute top-4 left-1/2 transform -translate-x-1/2 bg-gray-100 px-3 py-1 rounded-full text-xs font-bold text-gray-500 border border-gray-200">
                    48ë¶„ ì „ ë™ê¸°í™”</div>
                <div className="grid grid-cols-3 gap-2 mt-4 text-center">
                    <div className="flex flex-col items-center">
                        <Battery className="text-green-500 mb-2" size={24} /><span
                            className="text-xs text-gray-400 mb-0.5">ë°°í„°ë¦¬</span><span
                            className="font-bold text-gray-900 text-lg mb-2">85%</span>
                        <div className="w-full bg-gray-100 h-1.5 rounded-full overflow-hidden">
                            <div className="bg-green-500 h-full w-[85%]"></div>
                        </div>
                    </div>
                    <div className="flex flex-col items-center border-l border-r border-gray-100 px-2">
                        <Wifi className="text-blue-500 mb-2" size={24} /><span
                            className="text-xs text-gray-400 mb-0.5">ë„¤íŠ¸ì›Œí¬</span><span
                            className="font-bold text-gray-900 text-lg mb-2">ì—°ê²°ë¨</span>
                        <div className="flex items-center justify-center h-1.5">
                            <div className="w-2 h-2 rounded-full bg-green-500 animate-pulse"></div>
                        </div>
                    </div>
                    <div className="flex flex-col items-center">
                        <Pill className="text-orange-500 mb-2" size={24} /><span
                            className="text-xs text-gray-400 mb-0.5">ì•½ ì”ëŸ‰</span><span
                            className="font-bold text-gray-900 text-lg mb-2">3ê°œ</span>
                        <div className="w-full bg-gray-100 h-1.5 rounded-full overflow-hidden">
                            <div className="bg-orange-500 h-full w-[40%]"></div>
                        </div>
                    </div>
                </div>
            </Card>
        </section>
        <section>
            <h3 className="font-bold text-lg text-gray-900 mb-3">ì›ê²© ì œì–´</h3>
            <Card className="p-4">
                <p className="text-sm font-bold text-gray-500 mb-3">ë¡œë´‡ ì´ë™ ëª…ë ¹</p>
                <div className="grid grid-cols-3 gap-3 mb-4">
                    {[ { n: 'ê±°ì‹¤', i: Sofa }, { n: 'ì£¼ë°©', i: Utensils }, { n: 'ì¹¨ì‹¤', i: Bed }, { n: 'í™”ì¥ì‹¤', i: Bath }, { n:
                    'í˜„ê´€', i: LogOut }, { n: 'ì¶©ì „ê¸°', i: Zap } ].map((r, idx) => (
                    <button key={idx}
                        className="flex flex-col items-center justify-center bg-gray-50 py-4 rounded-2xl active:bg-blue-50 active:scale-95 transition-all">
                        <r.i size={24} className="text-gray-700 mb-2" /><span
                            className="text-sm font-medium text-gray-700">{r.n}</span>
                    </button>
                    ))}
                </div>
                <div className="grid grid-cols-2 gap-3 border-t border-gray-100 pt-4">
                    <button
                        className="flex items-center justify-center bg-blue-50 text-blue-600 py-3 rounded-xl font-bold text-sm">
                        <Mic size={18} className="mr-2" />ìŒì„± ë©”ì‹œì§€
                    </button>
                    <button
                        className="flex items-center justify-center bg-red-50 text-red-600 py-3 rounded-xl font-bold text-sm">
                        <StopCircle size={18} className="mr-2" />ë™ì‘ ì •ì§€
                    </button>
                </div>
            </Card>
            <Button variant="primary" className="mt-4 shadow-lg shadow-blue-200">
                <Camera size={20} className="mr-2" /> ì¦‰ì‹œ ìˆœì°° ì‹œì‘
            </Button>
        </section>
        <section>
            <SectionHeader title="LCD ë¯¸ëŸ¬ë§" action={<button onClick={onLcd}
                className="text-sm text-blue-500 font-medium flex items-center">ì „ì²´í™”ë©´
                <ArrowRight size={14} className="ml-1" /></button>} />
                <Card onClick={onLcd}
                    className="bg-gray-900 text-white relative overflow-hidden aspect-[4/3] rounded-[24px] flex flex-col items-center justify-center cursor-pointer active:scale-[0.98] transition-transform">
                    <div
                        className="absolute top-3 left-3 flex items-center space-x-2 bg-white/20 px-2 py-1 rounded backdrop-blur-sm">
                        <Monitor size={12} /><span className="text-[10px] font-medium">ì‹¤ì‹œê°„ í™”ë©´</span>
                    </div>
                    <div className="scale-[0.6] origin-center">
                        <div className="text-[100px] text-center animate-bounce-slow">ğŸ˜Š</div>
                        <div className="text-center mt-4">
                            <h1 className="text-4xl font-bold">14:30</h1>
                        </div>
                    </div>
                    <div className="absolute bottom-3 right-3 text-[10px] text-gray-500">Tap to expand</div>
                </Card>
        </section>
    </div>
</div>
);

// 3.11 LCD Preview Screen
const RobotLCDScreen = ({ onBack }) => (
<div className="min-h-screen bg-gray-900 flex flex-col">
    <Header leftIcon={<X size={24} />} onLeftClick={onBack} title="ë¡œë´‡ í™”ë©´ ë¯¸ëŸ¬ë§" transparent />
    <div className="flex-1 flex flex-col items-center justify-center p-6 bg-black/80 backdrop-blur-sm">
        <div
            className="w-full max-w-md aspect-[4/3] bg-black rounded-[32px] border-[12px] border-gray-800 shadow-2xl overflow-hidden relative flex items-center justify-center ring-4 ring-gray-700/50">
            <div className="absolute top-4 right-4 flex space-x-2 z-10">
                <div className="bg-red-600 text-white text-[10px] font-bold px-2 py-0.5 rounded animate-pulse">REC</div>
                <div className="bg-green-600 text-white text-[10px] font-bold px-2 py-0.5 rounded">BAT 85%</div>
            </div>
            <RobotFaceApp isPreview={true} />
        </div>
        <p className="text-gray-400 text-sm mt-8 animate-pulse">ì‹¤ì‹œê°„ ë¡œë´‡ í™”ë©´ ìˆ˜ì‹  ì¤‘...</p>
    </div>
</div>
);

// 3.7 History Screen
const HistoryScreen = ({ onBack }) => {
const [tab, setTab] = useState('report');
return (
<div className="min-h-screen bg-gray-50 pb-24">
    <Header leftIcon={<ChevronLeft size={24} />} onLeftClick={onBack} title="ê¸°ë¡" />
    <div className="bg-white px-5 pt-2 pb-4 border-b border-gray-100 sticky top-[52px] z-40">
        <div className="flex bg-gray-100 rounded-xl p-1 relative">
            <div className={`absolute top-1 bottom-1 w-[49%] bg-white rounded-lg shadow-sm transition-all duration-300
                ease-spring ${tab==='log' ? 'left-[50%]' : 'left-1' }`}></div>
            <button onClick={()=> setTab('report')} className={`flex-1 py-2.5 rounded-lg text-sm font-bold z-10
                transition-colors ${tab==='report' ? 'text-gray-900' : 'text-gray-400'}`}>AI ë¦¬í¬íŠ¸</button>
            <button onClick={()=> setTab('log')} className={`flex-1 py-2.5 rounded-lg text-sm font-bold z-10
                transition-colors ${tab==='log' ? 'text-gray-900' : 'text-gray-400'}`}>í™œë™ ë¡œê·¸</button>
        </div>
    </div>
    <div className="p-5 space-y-6">
        {tab === 'report' ? (
        <div className="space-y-5 animate-fade-in-up">
            <div
                className="bg-gradient-to-br from-blue-500 via-blue-600 to-indigo-600 text-white p-6 rounded-[24px] shadow-lg shadow-blue-200 relative overflow-hidden">
                <div
                    className="absolute top-0 right-0 w-32 h-32 bg-white opacity-10 rounded-full -mr-10 -mt-10 blur-2xl">
                </div>
                <div className="flex items-center mb-4 opacity-90">
                    <Bot size={18} className="mr-2" /><span className="text-sm font-bold tracking-wide">AI ì£¼ê°„ ë¶„ì„</span>
                </div>
                <h3 className="font-bold text-xl mb-3 leading-snug">"ì´ë²ˆ ì£¼ëŠ” ì „ë°˜ì ìœ¼ë¡œ<br />ì•ˆì •ì ì¸ ìƒíƒœì…ë‹ˆë‹¤."</h3>
                <p className="opacity-80 text-sm leading-relaxed">ë³µì•½ ìˆœì‘ë„ê°€ ì§€ë‚œì£¼ ëŒ€ë¹„ 5% ìƒìŠ¹í–ˆìŠµë‹ˆë‹¤. ê°ì • ìƒíƒœë„ ê¸ì •ì ì´ë©°, í™œë™ëŸ‰ì€ í‰ê·  ìˆ˜ì¤€ì„
                    ìœ ì§€í•˜ê³  ìˆìŠµë‹ˆë‹¤.</p>
            </div>
            <div className="grid grid-cols-2 gap-4">
                <Card className="text-center p-6">
                    <div className="text-sm text-gray-500 mb-1 font-medium">ë³µì•½ë¥ </div>
                    <div className="text-3xl font-bold text-gray-900 mb-1">92%</div>
                    <div className="text-xs text-red-500 font-bold bg-red-50 inline-block px-2 py-0.5 rounded-full">â–¼
                        1.2%</div>
                </Card>
                <Card className="text-center p-6">
                    <div className="text-sm text-gray-500 mb-1 font-medium">ê°ì • ìƒíƒœ</div>
                    <div className="text-3xl font-bold text-gray-900 mb-1">ê¸ì •</div>
                    <div className="text-xs text-green-600 font-bold bg-green-50 inline-block px-2 py-0.5 rounded-full">
                        ğŸ˜Š í‰ì˜¨í•¨</div>
                </Card>
            </div>
            <Card>
                <h4 className="font-bold text-gray-900 mb-4 flex items-center">
                    <FileText size={18} className="mr-2 text-gray-400" />ìì£¼ ì‚¬ìš©í•œ ë‹¨ì–´
                </h4>
                <div className="flex flex-wrap gap-2">{['#ì†ì (23íšŒ)', '#ê±´ê°• (18íšŒ)', '#ë‚ ì”¨ (12íšŒ)', '#ì‹ì‚¬ (8íšŒ)'].map((tag, i)
                    => (<span key={tag} className={`px-3 py-1.5 rounded-lg text-sm font-bold ${i===0
                        ? 'bg-blue-50 text-blue-600' : 'bg-gray-100 text-gray-500' }`}>{tag}</span>))}</div>
            </Card>
        </div>
        ) : (
        <div className="space-y-6 animate-fade-in-up">
            <div className="flex items-center space-x-2 sticky top-[120px] z-30 bg-gray-50 py-2"><span
                    className="font-bold text-lg text-gray-900">1ì›” 20ì¼ (ì˜¤ëŠ˜)</span><span
                    className="text-xs text-gray-500 bg-gray-200 px-1.5 py-0.5 rounded font-medium">â–¼</span></div>
            <div className="relative border-l-2 border-gray-200 ml-4 space-y-8 pl-8 pb-4">
                {[{ time: '10:00', icon: LogOut, bg: 'bg-orange-100', text: 'text-orange-600', title: 'ì™¸ì¶œ ê°ì§€', desc:
                'í˜„ê´€ë¬¸ ì—´ë¦¼ í™•ì¸ë¨' }, { time: '09:30', icon: Camera, bg: 'bg-blue-100', text: 'text-blue-600', title: 'ìˆœì°° ì™„ë£Œ',
                desc: 'ê°€ìŠ¤ë°¸ë¸Œ, ì „ì—´ê¸°êµ¬ ì •ìƒ' }, { time: '08:15', icon: Pill, bg: 'bg-green-100', text: 'text-green-600', title:
                'ì•„ì¹¨ ì•½ ë³µìš©', desc: 'ë””ìŠ¤íœì„œ ì‘ë™ ì™„ë£Œ' }, { time: '07:30', icon: Activity, bg: 'bg-yellow-100', text:
                'text-yellow-600', title: 'ê¸°ìƒ ê°ì§€', desc: 'ì¹¨ì‹¤ì—ì„œ ì›€ì§ì„ ê°ì§€' }].map((log, i) => (
                <div key={i} className="relative group">
                    <div
                        className="absolute -left-[39px] top-1 w-3 h-3 bg-white border-2 border-gray-200 rounded-full group-hover:border-blue-500 transition-colors">
                    </div>
                    <div className={`absolute -left-[54px] top-0 w-9 h-9 rounded-full ${log.bg} flex items-center
                        justify-center ring-4 ring-gray-50 z-10`}>
                        <log.icon size={16} className={log.text} />
                    </div>
                    <div
                        className="bg-white p-4 rounded-2xl shadow-sm border border-gray-100 hover:shadow-md transition-shadow">
                        <div className="flex justify-between items-start mb-1">
                            <h4 className="text-[15px] font-bold text-gray-900">{log.title}</h4>
                            <span className="text-xs font-bold text-gray-400">{log.time}</span>
                        </div>
                        <p className="text-sm text-gray-500">{log.desc}</p>
                    </div>
                </div>
                ))}
            </div>
        </div>
        )}
    </div>
</div>
);
};

// 3.8 Medication Screen
const MedicationScreen = ({ onBack }) => (
<div className="min-h-screen bg-gray-50 pb-24">
    <Header leftIcon={<ChevronLeft size={24} />} onLeftClick={onBack} title="ì•½ ê´€ë¦¬" />
    <div className="p-5 space-y-6 animate-fade-in">
        <Card className="overflow-visible">
            <div className="flex justify-between items-end mb-6">
                <div>
                    <h3 className="font-bold text-gray-900 text-lg">ì´ë²ˆ ì£¼ ë³µì•½ í˜„í™©</h3>
                    <p className="text-sm text-gray-500 mt-1">ì´ 6íšŒ ì¤‘ <span className="text-blue-500 font-bold">5íšŒ
                            ë³µìš©</span></p>
                </div>
                <div className="text-right">
                    <div className="text-3xl font-bold text-blue-500">83%</div>
                </div>
            </div>
            <div className="w-full bg-gray-100 rounded-full h-3 mb-6 overflow-hidden">
                <div className="bg-blue-500 h-full rounded-full" style={{width: '83%' }}></div>
            </div>
            <div className="grid grid-cols-7 gap-2 text-center">
                {['ì›”','í™”','ìˆ˜','ëª©','ê¸ˆ','í† ','ì¼'].map((d, i) => (
                <div key={d} className="flex flex-col items-center space-y-3">
                    <span className="text-xs text-gray-400 font-medium">{d}</span>
                    <div className={`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold
                        transition-all ${i < 3 ? 'bg-green-100 text-green-600' : i===3 ? 'bg-gray-100 text-gray-300'
                        : 'bg-transparent text-gray-200 border border-gray-100' }`}>
                        {i
                        < 3 ? <CheckCircle2 size={18} /> : i === 3 ? '-' : ''}
                    </div>
                </div>
                ))}
            </div>
        </Card>
        <section>
            <SectionHeader title="ë“±ë¡ëœ ì•½ ëª©ë¡" />
            <div className="space-y-3">
                <Card className="flex justify-between items-center py-5">
                    <div className="flex items-center space-x-4">
                        <div
                            className="w-12 h-12 bg-orange-50 text-orange-500 rounded-2xl flex items-center justify-center">
                            <Pill size={24} />
                        </div>
                        <div>
                            <h4 className="font-bold text-gray-900 text-[15px]">ê³ í˜ˆì••ì•½ (ì•„ì¹¨)</h4>
                            <p className="text-xs text-gray-500 mt-0.5">1ì • Â· ì•„ì¹¨ ì‹í›„ 30ë¶„</p>
                        </div>
                    </div>
                    <button
                        className="w-8 h-8 flex items-center justify-center rounded-full hover:bg-gray-100 text-gray-400">
                        <ChevronRight size={20} />
                    </button>
                </Card>
                <Card className="flex justify-between items-center py-5">
                    <div className="flex items-center space-x-4">
                        <div
                            className="w-12 h-12 bg-blue-50 text-blue-500 rounded-2xl flex items-center justify-center">
                            <Pill size={24} />
                        </div>
                        <div>
                            <h4 className="font-bold text-gray-900 text-[15px]">ë‹¹ë‡¨ì•½ (ì•„ì¹¨/ì €ë…)</h4>
                            <p className="text-xs text-gray-500 mt-0.5">1ì •ì”© Â· ì‹í›„ 30ë¶„</p>
                        </div>
                    </div>
                    <button
                        className="w-8 h-8 flex items-center justify-center rounded-full hover:bg-gray-100 text-gray-400">
                        <ChevronRight size={20} />
                    </button>
                </Card>
            </div>
            <Button variant="secondary" className="mt-4 text-blue-600 bg-blue-50 hover:bg-blue-100">
                <Plus size={18} className="mr-2" /> ì•½ ì¶”ê°€í•˜ê¸°
            </Button>
        </section>
        <Card className="bg-gray-900 text-white border-none shadow-xl shadow-gray-300">
            <div className="flex justify-between items-start mb-5">
                <div>
                    <h4 className="font-bold text-lg">ë””ìŠ¤íœì„œ ì”ëŸ‰</h4>
                    <p className="text-xs text-gray-400 mt-1">Bot-Care-V3 Â· <span className="text-green-400">ì—°ê²°ë¨</span>
                    </p>
                </div>
                <div
                    className="bg-orange-500/20 text-orange-400 px-3 py-1 rounded-lg text-xs font-bold border border-orange-500/50">
                    ë³´ì¶© í•„ìš”</div>
            </div>
            <div className="flex space-x-1.5 mb-4 h-10 items-end">
                {[1,1,1,0,0,0,0].map((v, i) => (
                <div key={i} className={`flex-1 rounded-md transition-all duration-500 ${v ? 'bg-green-500 h-full'
                    : 'bg-gray-700 h-2' }`}></div>
                ))}
            </div>
            <div className="flex items-center justify-between text-sm">
                <span className="text-gray-400">ë‚¨ì€ ìš©ëŸ‰: 3ì¼ë¶„</span>
                <button
                    className="text-white font-bold text-xs bg-gray-700 px-3 py-1.5 rounded-lg hover:bg-gray-600">ì£¼ë¬¸í•˜ê¸°</button>
            </div>
        </Card>
    </div>
</div>
);

// 3.9 Notification Screen
const NotificationScreen = ({ onBack }) => {
const notifications = [
{ id: 1, type: 'danger', title: 'ë‚™ìƒ ê°ì§€', msg: 'ê±°ì‹¤ì—ì„œ ë‚™ìƒ ê°ì§€ë¨. ì¦‰ì‹œ í™•ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.', time: 'ë°©ê¸ˆ ì „', read: false },
{ id: 2, type: 'success', title: 'ì•½ ë³µìš© ì™„ë£Œ', msg: 'ì•„ì¹¨ ì•½(ê³ í˜ˆì••ì•½) ë³µìš©ì„ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤.', time: '2ì‹œê°„ ì „', read: false },
{ id: 3, type: 'info', title: 'ê¸°ìƒ ì•Œë¦¼', msg: 'ì˜¤ì „ 7:30 ê¸°ìƒ í™•ì¸ë¨', time: '3ì‹œê°„ ì „', read: true },
{ id: 4, type: 'warning', title: 'ì¼ì • ì•Œë¦¼', msg: 'ë³‘ì› ì˜ˆì•½ 2ì‹œê°„ ì „ì…ë‹ˆë‹¤. ì¤€ë¹„í•´ì£¼ì„¸ìš”.', time: 'ì–´ì œ', read: true }
];

const getIcon = (type) => {
if (type === 'danger') return <div className="bg-red-100 p-2 rounded-full text-red-500">
    <AlertCircle size={20} />
</div>;
if (type === 'success') return <div className="bg-green-100 p-2 rounded-full text-green-500">
    <Pill size={20} />
</div>;
if (type === 'info') return <div className="bg-blue-100 p-2 rounded-full text-blue-500">
    <Activity size={20} />
</div>;
return <div className="bg-orange-100 p-2 rounded-full text-orange-500">
    <Calendar size={20} />
</div>;
};

return (
<div className="min-h-screen bg-gray-50 pb-24">
    <Header leftIcon={<ChevronLeft size={24} />} onLeftClick={onBack} title="ì•Œë¦¼" rightIcon={<span
        className="text-xs text-gray-500 font-medium cursor-pointer hover:text-gray-900">ëª¨ë‘ ì½ìŒ</span>} />
    <div className="p-5 space-y-4 animate-fade-in">
        <p className="text-xs font-bold text-gray-400 px-1">ì˜¤ëŠ˜</p>
        {notifications.map((noti) => (
        <div key={noti.id} className={`bg-white p-4 rounded-2xl border transition-all ${!noti.read
            ? 'border-blue-200 bg-blue-50/10 shadow-sm' : 'border-gray-100' }`}>
            <div className="flex items-start space-x-3">
                <div className="mt-0.5 flex-shrink-0">{getIcon(noti.type)}</div>
                <div className="flex-1">
                    <div className="flex justify-between items-start mb-1">
                        <h4 className={`text-[15px] font-bold ${noti.type==='danger' ? 'text-red-600' : 'text-gray-900'
                            } ${noti.read ? 'opacity-80' : '' }`}>{noti.title}</h4>
                        <span className="text-xs text-gray-400 font-medium whitespace-nowrap ml-2">{noti.time}</span>
                    </div>
                    <p className={`text-[13px] leading-snug ${noti.read ? 'text-gray-400' : 'text-gray-600' }`}>
                        {noti.msg}</p>

                    {noti.type === 'danger' && (
                    <button
                        className="mt-3 w-full bg-red-50 text-red-600 text-xs font-bold py-2.5 rounded-xl hover:bg-red-100 transition-colors flex items-center justify-center">
                        <Camera size={14} className="mr-1.5" /> í˜„ì¥ í™”ë©´ í™•ì¸í•˜ê¸°
                    </button>
                    )}
                </div>
                {!noti.read && <div className="w-2 h-2 bg-blue-500 rounded-full mt-1.5"></div>}
            </div>
        </div>
        ))}
    </div>
</div>
);
};

// 3.10 Emergency Screen
const EmergencyScreen = ({ onBack }) => (
<div
    className="min-h-screen bg-gray-900 relative flex flex-col items-center justify-center p-6 text-center animate-fade-in overflow-hidden">
    {/* Background Pulse */}
    <div className="absolute inset-0 bg-red-600/20 animate-pulse"></div>
    <div className="absolute inset-0 bg-gradient-to-b from-black/50 via-transparent to-red-900/80"></div>

    <div className="relative z-10 w-full max-w-sm flex flex-col h-full justify-center">
        <div className="mb-8">
            <div
                className="inline-flex p-5 rounded-full bg-red-500/20 text-red-500 animate-bounce mb-4 border-2 border-red-500/50 box-content">
                <Siren size={56} />
            </div>
            <h1 className="text-3xl font-bold text-white mb-2 tracking-tight">ê¸´ê¸‰ ìƒí™© ë°œìƒ</h1>
            <p className="text-red-200 text-lg font-medium">ë‚™ìƒì´ ê°ì§€ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
        </div>

        {/* Mock Camera Snapshot */}
        <div className="bg-gray-800 rounded-2xl overflow-hidden mb-8 border border-gray-700 shadow-2xl relative group">
            <div className="aspect-video bg-gray-700 flex items-center justify-center relative">
                <Camera size={48} className="text-gray-600" />
                <div className="absolute inset-0 bg-black/40 flex items-center justify-center">
                    <span className="text-gray-400 text-sm font-medium">ì¹´ë©”ë¼ ì—°ê²° ì¤‘...</span>
                </div>
                <div className="absolute top-3 left-3 flex items-center space-x-2">
                    <div className="w-2 h-2 bg-red-500 rounded-full animate-pulse"></div>
                    <span className="text-xs text-white font-bold bg-black/50 px-2 py-0.5 rounded">LIVE</span>
                </div>
            </div>
            <div className="p-4 text-left bg-gray-800 border-t border-gray-700">
                <div className="flex justify-between items-center mb-1">
                    <span className="text-white font-bold text-lg">ê±°ì‹¤</span>
                    <span className="text-red-400 text-xs font-bold bg-red-900/30 px-2 py-1 rounded">ì¶©ê²© ê°ì§€ 1ë¶„ ì „</span>
                </div>
                <p className="text-gray-400 text-sm">ë¡œë´‡ì´ í˜„ì¥ìœ¼ë¡œ ì´ë™ ì¤‘ì…ë‹ˆë‹¤.</p>
            </div>
        </div>

        <div className="space-y-3 w-full">
            <Button
                className="bg-red-600 hover:bg-red-700 text-white border-none py-4 text-lg shadow-lg shadow-red-900/50 animate-pulse">
                <Phone className="mr-2" /> 119 ì‹ ê³ í•˜ê¸°
            </Button>
            <Button variant="white" onClick={onBack}
                className="bg-white/10 hover:bg-white/20 text-white border-transparent backdrop-blur-md">
                ë³´í˜¸ì ì§ì ‘ í†µí™”
            </Button>
        </div>

        <button onClick={onBack} className="mt-8 text-gray-500 text-sm underline hover:text-gray-300 transition-colors">
            ì˜¤ì¸ ê°ì§€ë¡œ ì•Œë¦¼ ë„ê¸°
        </button>
    </div>
</div>
);

// 3.12 Settings Screen
const SettingsScreen = ({ onBack, onLogout }) => (
<div className="min-h-screen bg-gray-50 pb-24">
    <Header leftIcon={<ChevronLeft size={24} />} onLeftClick={onBack} title="ì„¤ì •" />
    <div className="p-5 space-y-6 animate-fade-in">
        {/* Profile Section */}
        <section>
            <div className="flex justify-between items-center mb-2 px-1">
                <h3 className="font-bold text-gray-900 flex items-center text-base">
                    <User size={18} className="mr-2 text-gray-500" /> ë‚´ ì •ë³´
                </h3>
            </div>
            <Card className="flex justify-between items-center p-4">
                <div className="flex items-center space-x-4">
                    <div className="w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center text-2xl">ğŸ‘¨â€ğŸ’¼
                    </div>
                    <div>
                        <h4 className="font-bold text-gray-900 text-base">ê¹€ë³µì§€ (ë³µì§€ì‚¬)</h4>
                        <p className="text-sm text-gray-500">welfare@example.com</p>
                    </div>
                </div>
                <button className="text-sm text-blue-500 font-bold bg-blue-50 px-3 py-1.5 rounded-lg">ìˆ˜ì •</button>
            </Card>
        </section>

        {/* Notifications Toggle */}
        <section>
            <h3 className="font-bold text-gray-900 mb-3 px-1 flex items-center text-base">
                <Bell size={18} className="mr-2 text-gray-500" /> ì•Œë¦¼ ì„¤ì •
            </h3>
            <div className="bg-white rounded-[20px] border border-gray-100 overflow-hidden shadow-sm">
                {[{ label: 'ê¸´ê¸‰ ì•Œë¦¼', desc: 'ë‚™ìƒ, ë¯¸í™œë™ ë“± ìœ„í—˜ ê°ì§€', on: true }, { label: 'ë³µì•½ ì•Œë¦¼', desc: 'ì•½ ë³µìš©/ë¯¸ë³µìš© í™•ì¸', on: true
                }, { label: 'ì¼ìƒ ì•Œë¦¼', desc: 'ê¸°ìƒ, ì‹ì‚¬ ë“± ìƒí™œ íŒ¨í„´', on: false }, { label: 'ì´ë©”ì¼ ë¦¬í¬íŠ¸', desc: 'ì£¼ê°„ í™œë™ ë¶„ì„ ìˆ˜ì‹ ', on:
                false }].map((item, i) => (
                <div key={i} className={`flex justify-between items-center p-4 ${i !==3 ? 'border-b border-gray-50' : ''
                    } hover:bg-gray-50 transition-colors`}>
                    <div>
                        <div className="font-bold text-gray-900 text-[15px]">{item.label}</div>
                        <div className="text-xs text-gray-500 mt-0.5">{item.desc}</div>
                    </div>
                    <div className={`w-12 h-7 rounded-full relative transition-colors cursor-pointer ${item.on
                        ? 'bg-blue-500' : 'bg-gray-200' }`}>
                        <div className={`w-6 h-6 bg-white rounded-full absolute top-0.5 transition-transform shadow-sm
                            ${item.on ? 'left-[22px]' : 'left-0.5' }`}></div>
                    </div>
                </div>
                ))}
            </div>
        </section>

        {/* Robot Config */}
        <section>
            <div className="flex justify-between items-center mb-3 px-1">
                <h3 className="font-bold text-gray-900 flex items-center text-base">
                    <Bot size={18} className="mr-2 text-gray-500" /> ë¡œë´‡ ì„¤ì •
                </h3>
                <span className="text-[11px] bg-gray-200 text-gray-600 px-2 py-0.5 rounded font-bold">ê¹€ì˜¥ë¶„ ë‹˜</span>
            </div>
            <Card className="space-y-6">
                <div className="flex justify-between items-center">
                    <span className="text-sm font-bold text-gray-700">ì•„ì¹¨ ì•½ ì•Œë¦¼</span>
                    <div
                        className="flex items-center space-x-2 bg-gray-50 px-3 py-1.5 rounded-lg border border-gray-100">
                        <ClockIcon size={14} className="text-gray-400" /><span
                            className="text-sm font-bold text-blue-600">08:00</span>
                    </div>
                </div>
                <div className="flex justify-between items-center">
                    <span className="text-sm font-bold text-gray-700">ì €ë… ì•½ ì•Œë¦¼</span>
                    <div
                        className="flex items-center space-x-2 bg-gray-50 px-3 py-1.5 rounded-lg border border-gray-100">
                        <ClockIcon size={14} className="text-gray-400" /><span
                            className="text-sm font-bold text-blue-600">19:00</span>
                    </div>
                </div>
                <div className="pt-2 border-t border-gray-50">
                    <div className="flex justify-between text-sm mb-3"><span
                            className="font-bold text-gray-700 flex items-center">
                            <Volume2 size={16} className="mr-1.5 text-gray-400" /> ìŒì„± ë³¼ë¥¨
                        </span><span className="text-blue-500 font-bold">70%</span></div>
                    <div className="w-full bg-gray-100 h-2 rounded-full overflow-hidden relative cursor-pointer">
                        <div className="bg-blue-500 h-full w-[70%] absolute top-0 left-0"></div>
                    </div>
                </div>
            </Card>
        </section>

        <section>
            <h3 className="font-bold text-gray-900 mb-3 px-1 flex items-center text-base">
                <Phone size={18} className="mr-2 text-gray-500" /> ë¹„ìƒ ì—°ë½ë§
            </h3>
            <div className="bg-white rounded-[20px] border border-gray-100 overflow-hidden shadow-sm">
                <div
                    className="flex justify-between items-center p-4 border-b border-gray-50 hover:bg-gray-50 transition-colors">
                    <div className="flex items-center space-x-3">
                        <div
                            className="bg-red-50 text-red-500 w-8 h-8 rounded-full flex items-center justify-center font-bold text-xs">
                            1</div>
                        <div>
                            <div className="font-bold text-gray-900 text-sm">ì•„ë“¤ (ê¹€ì² ìˆ˜)</div>
                            <div className="text-xs text-gray-400">010-1234-5678</div>
                        </div>
                    </div>
                    <button className="text-gray-300 p-2">
                        <Edit2 size={16} />
                    </button>
                </div>
                <div className="flex justify-between items-center p-4 hover:bg-gray-50 transition-colors">
                    <div className="flex items-center space-x-3">
                        <div
                            className="bg-blue-50 text-blue-500 w-8 h-8 rounded-full flex items-center justify-center font-bold text-xs">
                            2</div>
                        <div>
                            <div className="font-bold text-gray-900 text-sm">ë‹´ë‹¹ ë³µì§€ì‚¬</div>
                            <div className="text-xs text-gray-400">010-9876-5432</div>
                        </div>
                    </div>
                    <button className="text-gray-300 p-2">
                        <Edit2 size={16} />
                    </button>
                </div>
            </div>
        </section>

        <div className="pt-4 pb-8">
            <button onClick={onLogout}
                className="w-full py-4 text-gray-400 text-sm font-medium hover:text-gray-600 transition-colors">ë¡œê·¸ì•„ì›ƒ</button>
        </div>
    </div>
</div>
);

/**
* ğŸ§­ Main App Logic Container (Guardian Side)
*/
const GuardianAppContainer = ({ onLogout }) => {
const [currentScreen, setCurrentScreen] = useState('elders');
const [selectedElder, setSelectedElder] = useState(null);
const [activeTab, setActiveTab] = useState('home');

// Navigation Helpers
const goBack = () => {
if (['dashboard', 'elders'].includes(currentScreen)) setCurrentScreen('elders');
else setCurrentScreen('dashboard');
};

const handleTabChange = (tabId) => {
setActiveTab(tabId);
if (tabId === 'home') setCurrentScreen('dashboard');
if (tabId === 'robot') setCurrentScreen('robot');
if (tabId === 'pill') setCurrentScreen('medication');
if (tabId === 'cal') setCurrentScreen('schedule');
if (tabId === 'more') setCurrentScreen('settings');
};

// Switch Screens
if (currentScreen === 'elders') {
return (
<ElderSelectScreen onSelect={(elder)=> { setSelectedElder(elder); setCurrentScreen('dashboard'); }}
    onSettings={() => setCurrentScreen('settings')}
    onEmergency={() => setCurrentScreen('emergency')}
    />
    );
    }

    // Dashboard & Sub Screens
    return (
    <div className="pb-24">
        {currentScreen === 'dashboard' && <DashboardScreen elder={selectedElder} onBack={()=>
            setCurrentScreen('elders')} onNoti={() => setCurrentScreen('notifications')} onHistory={() =>
            setCurrentScreen('history')} />}
            {currentScreen === 'robot' && <RobotControlScreen onBack={goBack} onLcd={()=> setCurrentScreen('lcd')} />}
                {currentScreen === 'schedule' && <ScheduleScreen onBack={goBack} onNoti={()=>
                    setCurrentScreen('notifications')} />}
                    {currentScreen === 'medication' &&
                    <MedicationScreen onBack={goBack} />}
                    {currentScreen === 'history' &&
                    <HistoryScreen onBack={goBack} />}
                    {currentScreen === 'notifications' &&
                    <NotificationScreen onBack={goBack} />}
                    {currentScreen === 'settings' && <SettingsScreen onBack={currentScreen==='settings' &&
                        !selectedElder ? ()=> setCurrentScreen('elders') : goBack} onLogout={onLogout} />}
                        {currentScreen === 'emergency' &&
                        <EmergencyScreen onBack={goBack} />}
                        {currentScreen === 'lcd' &&
                        <RobotLCDScreen onBack={goBack} />}

                        {/* Bottom Nav (Only on main tabs AND when elder is selected) */}
                        {selectedElder && !['elders', 'emergency', 'lcd'].includes(currentScreen) && (
                        <div
                            className="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-100 pb-6 pt-2 px-6 h-[84px] z-50 rounded-t-[20px] shadow-[0_-5px_20px_rgba(0,0,0,0.03)]">
                            <div className="flex justify-between items-center h-full pb-2">
                                {[{ id: 'home', icon: Home, label: 'í™ˆ' }, { id: 'robot', icon: Bot, label: 'ë¡œë´‡' }, { id:
                                'pill', icon: Pill, label: 'ì•½' }, { id: 'cal', icon: Calendar, label: 'ì¼ì •' }, { id:
                                'more', icon: List, label: 'ë”ë³´ê¸°' }].map((item) => {
                                const isActive = activeTab === item.id;
                                const Icon = item.icon;
                                return (
                                <button key={item.id} onClick={()=> handleTabChange(item.id)} className={`flex flex-col
                                    items-center justify-center w-14 space-y-1 transition-all duration-200 ${isActive ?
                                    'text-gray-900 -translate-y-1' : 'text-gray-400 hover:text-gray-600'}`}>
                                    <Icon size={26} strokeWidth={isActive ? 2.5 : 2} />
                                    <span className={`text-[11px] ${isActive ? 'font-bold' : 'font-medium'
                                        }`}>{item.label}</span>
                                </button>
                                );
                                })}
                            </div>
                        </div>
                        )}
    </div>
    );
    };

    /**
    * ğŸ§­ Root Application
    */
    export default function App() {
    const [authMode, setAuthMode] = useState('none'); // 'none', 'guardian', 'robot'

    const handleLogin = (role) => {
    setAuthMode(role);
    };

    const handleLogout = () => {
    setAuthMode('none');
    };

    return (
    <div className="max-w-md mx-auto bg-white min-h-screen shadow-2xl overflow-hidden font-sans text-gray-900 relative">
        <style>
            {
                ` @keyframes fade-in-up {
                    from {
                        opacity: 0;
                        transform: translateY(10px);
                    }

                    to {
                        opacity: 1;
                        transform: translateY(0);
                    }
                }

                @keyframes bounce-slow {

                    0%,
                    100% {
                        transform: translateY(0);
                    }

                    50% {
                        transform: translateY(-10px);
                    }
                }

                @keyframes wobble {
                    0% {
                        transform: rotate(0deg);
                    }

                    15% {
                        transform: rotate(-5deg);
                    }

                    30% {
                        transform: rotate(3deg);
                    }

                    45% {
                        transform: rotate(-3deg);
                    }

                    60% {
                        transform: rotate(2deg);
                    }

                    75% {
                        transform: rotate(-1deg);
                    }

                    100% {
                        transform: rotate(0deg);
                    }
                }

                .animate-fade-in-up {
                    animation: fade-in-up 0.6s ease-out forwards;
                }

                .animate-bounce-slow {
                    animation: bounce-slow 3s infinite ease-in-out;
                }

                .animate-wobble {
                    animation: wobble 2s infinite;
                }

                .animate-pulse-slow {
                    animation: pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite;
                }

                .scrollbar-hide::-webkit-scrollbar {
                    display: none;
                }

                .pb-safe {
                    padding-bottom: env(safe-area-inset-bottom);
                }

                .pattern-dots {
                    background-image: radial-gradient(#ffffff 1px, transparent 1px);
                    background-size: 20px 20px;
                }

                .ease-spring {
                    transition-timing-function: cubic-bezier(0.34, 1.56, 0.64, 1);
                }

                `
            }
        </style>

        {/* 1. Login Screen (Entry Point) */}
        {authMode === 'none' && <LoginScreen onLogin={handleLogin} onSignup={()=> {}} />}

            {/* 2. Robot Mode (Full Screen LCD) */}
            {authMode === 'robot' &&
            <RobotFaceApp onLogout={handleLogout} />}

            {/* 3. Guardian Mode (App Dashboard) */}
            {authMode === 'guardian' &&
            <GuardianAppContainer onLogout={handleLogout} />}
    </div>
    );
    }